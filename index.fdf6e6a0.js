var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},i={},a=t.parcelRequire6af4;null==a&&((a=function(t){if(t in e)return e[t].exports;if(t in i){var a=i[t];delete i[t];var s={id:t,exports:{}};return e[t]=s,a.call(s.exports,s,s.exports),s.exports}var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){i[t]=e},t.parcelRequire6af4=a);var s=a("ltQS0"),r=a("axHCK"),n=a("d6DLj"),h=a("c6GPX"),c=a("d4PzE"),o=a("2b25J"),l=a("466t7"),d=a("5mF43"),u=a("8208i"),p=a("aisEY");const f=window.innerWidth+600,g=window.innerHeight+600,m=new class{get tick$(){return this._tick$.asObservable().pipe((0,n.filter)((t=>t<3e3)))}constructor(t,e,i,a,s){this.canvasFactory=t,this.document=e,this.width=i,this.height=a,this.offset=s,this.realCanvas=this.canvasFactory.createCanvas(this.width,this.height),this.leftSideImg=this.document.createElement("img"),this.rightSideImg=this.document.createElement("img"),this._tick$=new(0,r.BehaviorSubject)(0),this.sides=(0,p.generateSides)(this.width,this.height);const n=e.querySelector(".root");n?.appendChild(this.realCanvas.canvas),this.setup()}dispatch(){this._tick$.next(this._tick$.value+1)}setup(){this.realCanvas.fill("black"),this.tick$.pipe((0,n.filter)((t=>t%300==0)),(0,c.map)((()=>{this.currentLine=(0,p.createLine)(this.sides,this.offset);const t=(0,p.calcLineLength)(this.currentLine.start,this.currentLine.end),e=(0,p.generateTornLine)(this.currentLine.start,this.currentLine.end,t,parseInt(""+t/7,10),Math.PI);return(0,p.generateFigureShape)(e,this.width,this.height,this.sides)})),(0,l.switchMap)((t=>(0,h.forkJoin)([this.drawPathOnTempCanvas(t.left),this.drawPathOnTempCanvas(t.right)]))),(0,d.tap)((([t,e])=>{this.leftSideImg.src=t,this.rightSideImg.src=e}))).subscribe(),this.tick$.pipe((0,n.filter)((t=>t%300!=0)),(0,c.map)((t=>t%300)),(0,c.map)((t=>{const e={x:this.currentLine.end.x-this.currentLine.start.x,y:this.currentLine.end.y-this.currentLine.start.y},i=(0,p.calcLineAngle)(e);return{left:(0,p.calcPointInPolarSystem)(i-Math.PI/2,t/25),right:(0,p.calcPointInPolarSystem)(i+Math.PI/2,t/25)}})),(0,l.switchMap)((({left:t,right:e})=>(0,h.forkJoin)([this.realCanvas.reset(),this.realCanvas.clear(),(0,u.fromPromise)(Promise.resolve().then((()=>this.realCanvas.fill("black")))),this.realCanvas.drawImage(this.leftSideImg,t),this.realCanvas.drawImage(this.rightSideImg,e)])))).subscribe()}drawPathOnTempCanvas(t){return(0,o.of)(this.canvasFactory.createCanvas(this.width,this.height)).pipe((0,l.switchMap)((e=>(0,h.forkJoin)([e.drawPath(t,"white","black"),e.drawImage(this.realCanvas.canvas,{x:0,y:0})]).pipe((0,l.switchMap)((()=>e.toDataUrl()))))))}}(new(0,s.CanvasFactory)(document),document,f,g,{x:600,y:600});!function t(){m.dispatch(),requestAnimationFrame(t)}();
//# sourceMappingURL=index.fdf6e6a0.js.map
