var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},i={},s=t.parcelRequire6af4;null==s&&((s=function(t){if(t in e)return e[t].exports;if(t in i){var s=i[t];delete i[t];var a={id:t,exports:{}};return e[t]=a,s.call(a.exports,a,a.exports),a.exports}var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){i[t]=e},t.parcelRequire6af4=s);var a=s("axHCK"),n=s("d6DLj"),r=s("c6GPX"),h=s("d4PzE"),c=s("2b25J"),o=s("466t7"),d=s("5mF43"),l=s("8208i"),g=s("aisEY");var f=s("ltQS0"),u=s("b8iNZ");const p=window.innerWidth+600,m=window.innerHeight+600,v=new class{get tick$(){return this._tick$.asObservable()}constructor(t,e,i,s,n,r){this.canvasFactory=t,this.document=e,this.width=i,this.height=s,this.offset=n,this.settings=r,this.realCanvas=this.canvasFactory.createCanvas(this.width,this.height),this.leftSideImg=this.document.createElement("img"),this.rightSideImg=this.document.createElement("img"),this._tick$=new(0,a.BehaviorSubject)(0),this.sides=(0,g.generateSides)(this.width,this.height);const h=e.querySelector(".root");h?.appendChild(this.realCanvas.canvas),this.setup()}dispatch(){this._tick$.next(this._tick$.value+1)}setup(){this.realCanvas.fill(this.settings.data.backgroundColor),this.tick$.pipe((0,n.filter)((t=>t%this.settings.data.lineLifeTicks==0)),(0,h.map)((()=>{this.currentLine=(0,g.createLine)(this.sides,this.offset);const t=(0,g.calcLineLength)(this.currentLine.start,this.currentLine.end),e=(0,g.generateTornLine)(this.currentLine.start,this.currentLine.end,t,parseInt(""+t/7,10),Math.PI);return(0,g.generateFigureShape)(e,this.width,this.height,this.sides)})),(0,o.switchMap)((t=>(0,r.forkJoin)([this.drawPathOnTempCanvas(t.left),this.drawPathOnTempCanvas(t.right)]))),(0,d.tap)((([t,e])=>{this.leftSideImg.src=t,this.rightSideImg.src=e}))).subscribe(),this.tick$.pipe((0,n.filter)((t=>t%this.settings.data.lineLifeTicks!=0)),(0,h.map)((t=>t%this.settings.data.lineLifeTicks)),(0,h.map)((t=>{const e={x:this.currentLine.end.x-this.currentLine.start.x,y:this.currentLine.end.y-this.currentLine.start.y},i=(0,g.calcLineAngle)(e),s=Math.PI/2;return{left:(0,g.calcPointInPolarSystem)(i-s,t/this.settings.data.distanceCoefficient),right:(0,g.calcPointInPolarSystem)(i+s,t/this.settings.data.distanceCoefficient)}})),(0,o.switchMap)((({left:t,right:e})=>(0,r.forkJoin)([this.realCanvas.clear(),(0,l.fromPromise)(Promise.resolve().then((()=>this.realCanvas.fill(this.settings.data.backgroundColor)))),this.realCanvas.drawImage(this.leftSideImg,t),this.realCanvas.drawImage(this.rightSideImg,e)])))).subscribe()}drawPathOnTempCanvas(t){return(0,c.of)(this.canvasFactory.createCanvas(this.width,this.height)).pipe((0,o.switchMap)((e=>(0,r.forkJoin)([e.drawPath(t,this.settings.data.lineColor,this.settings.data.backgroundColor),e.drawImage(this.realCanvas.canvas,{x:0,y:0})]).pipe((0,o.switchMap)((()=>e.toDataUrl()))))))}}(new(0,f.CanvasFactory)(document),document,p,m,{x:600,y:600},u.settings);!function t(){v.dispatch(),requestAnimationFrame(t)}();
//# sourceMappingURL=index.64bddc0d.js.map
